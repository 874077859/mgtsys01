<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vip.mgtsys.dao.EmployeeDao">
    <!-- 定义缓存  一般是一级缓存，如果用同一个sqlsession 那么相同查询直接会从缓存中查找 
    <cache size="1024" flushInterval="60000" eviction="LRU" readOnly="false"></cache>
    -->
    <resultMap id="employeeInfo" type="com.vip.mgtsys.model.EmployeeInfo">
        <id property="sid" column="sid"/>
        <id property="employeeId" column="employee_id"/>
        <result property="employeeName" column="employee_name"/>
    </resultMap>
    
    <!-- 查找所有 -->
    <select id="getEmployeeInfo" resultMap="employeeInfo">
        select employee_id, employee_name from tbl_sys_employee
        <where>
            <if test="usrId != null and usrId != '' ">
                and employee_id = #{usrId}
            </if>
            <if test="pwd != null and pwd != '' ">
                and employee_pwd = #{pwd}
            </if>
            <if test="sid != null and sid != '' ">
                and sid = #{sid}
            </if>
        </where>
    </select>
    
    <insert id="insertEmployee">
        insert into tbl_sys_employee
        (
          sid,
          employee_id,
          employee_pwd,
          employee_mail,
          employee_status,
          employee_type
        )
        values(
          #{sid},
          #{employeeId},
          #{employeePwd},
          #{employeeMail},
          #{employeeStatus},
          #{employeeType}
        )
    </insert>
    
    <select id="getMaxSid" resultType="int">
        select
            count(1)
        from
            tbl_sys_employee
        where
            create_time >= #{sysDate}
    </select>
</mapper>